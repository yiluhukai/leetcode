package  main
//ç»™å®šä¸€ä¸ªäºŒå‰æœç´¢æ ‘çš„æ ¹èŠ‚ç‚¹ root å’Œä¸€ä¸ªå€¼ keyï¼Œåˆ é™¤äºŒå‰æœç´¢æ ‘ä¸­çš„ key å¯¹åº”çš„èŠ‚ç‚¹ï¼Œå¹¶ä¿è¯äºŒå‰æœç´¢æ ‘çš„æ€§è´¨ä¸å˜ã€‚è¿”å›äºŒå‰æœç´¢æ ‘ï¼ˆæœ‰å¯èƒ½è¢«æ›´æ–°ï¼‰çš„
//æ ¹èŠ‚ç‚¹çš„å¼•ç”¨ã€‚ 
//
// ä¸€èˆ¬æ¥è¯´ï¼Œåˆ é™¤èŠ‚ç‚¹å¯åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š 
//
// 
// é¦–å…ˆæ‰¾åˆ°éœ€è¦åˆ é™¤çš„èŠ‚ç‚¹ï¼› 
// å¦‚æœæ‰¾åˆ°äº†ï¼Œåˆ é™¤å®ƒã€‚ 
// 
//
// è¯´æ˜ï¼š è¦æ±‚ç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸º O(h)ï¼Œh ä¸ºæ ‘çš„é«˜åº¦ã€‚ 
//
// ç¤ºä¾‹: 
//
// 
//root = [5,3,6,2,4,null,7]
//key = 3
//
//    5
//   / \
//  3   6
// / \   \
//2   4   7
//
//ç»™å®šéœ€è¦åˆ é™¤çš„èŠ‚ç‚¹å€¼æ˜¯ 3ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆæ‰¾åˆ° 3 è¿™ä¸ªèŠ‚ç‚¹ï¼Œç„¶ååˆ é™¤å®ƒã€‚
//
//ä¸€ä¸ªæ­£ç¡®çš„ç­”æ¡ˆæ˜¯ [5,4,6,2,null,null,7], å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚
//
//    5
//   / \
//  4   6
// /     \
//2       7
//
//å¦ä¸€ä¸ªæ­£ç¡®ç­”æ¡ˆæ˜¯ [5,2,6,null,4,null,7]ã€‚
//
//    5
//   / \
//  2   6
//   \   \
//    4   7
// 
// Related Topics æ ‘ 
// ğŸ‘ 447 ğŸ‘ 0

type TreeNode struct {
	Val int
	Left *TreeNode
	Right *TreeNode
}
//leetcode submit region begin(Prohibit modification and deletion)
/**
 * Definition for a binary tree node.
 * type TreeNode struct {
 *     Val int
 *     Left *TreeNode
 *     Right *TreeNode
 * }
 */
//é¦–å…ˆå†äºŒå‰æ ‘ä¸­æœç´¢è¦åˆ é™¤çš„èŠ‚ç‚¹
//è§£ç­”æˆåŠŸ:
//æ‰§è¡Œè€—æ—¶:4 ms,å‡»è´¥äº†100.00% çš„Goç”¨æˆ·
//å†…å­˜æ¶ˆè€—:6.9 MB,å‡»è´¥äº†14.10% çš„Goç”¨æˆ·

// åˆ é™¤èŠ‚ç‚¹çš„æ—¶å€™å³ä¸‰ç§æƒ…å†µï¼šç¬¬ä¸€ç§æ˜¯è¦åˆ é™¤çš„èŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹ï¼Œç›´æ¥ä»çˆ¶èŠ‚ç‚¹ä¸Šåˆ é™¤å³å¯
// ç¬¬äºŒç§æ˜¯å³å­æ ‘çš„æƒ…å†µï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹çš„ä¸­åºéå†çš„åç»§èŠ‚ç‚¹ä¸€å®šå¯ä»¥æ›¿æ¢å½“å‰èŠ‚ç‚¹çš„å€¼ï¼Œä¸”åç»§èŠ‚ç‚¹ä½äºå½“å‰èŠ‚ç‚¹çš„å³å­æ ‘ä¸Š
// ç¬¬ä¸‰ç§æƒ…å†µæ˜¯æœ‰å·¦å­æ ‘ï¼Œé‚£ä¹ˆå½“å‰èŠ‚ç‚¹ä¸­åºéå†çš„å‰é©±èŠ‚ç‚¹ä¸€å®šå¯ä»¥æ›¿æ¢å½“å‰èŠ‚ç‚¹çš„å€¼è€Œä¸å½±å“æ ‘çš„å¹³è¡¡ï¼Œä¸”å‰é©±èŠ‚ç‚¹ä¹Ÿä½äºè¯¥èŠ‚ç‚¹çš„å­æ ‘ä¸Šã€‚
// æ›¿æ¢åä¸ºäº†ä½¿æ ‘ç»´æŒå¹³è¡¡ï¼Œæˆ‘ä»¬åº”è¯¥å»å­æ ‘ä¸Šåˆ é™¤è¯¥èŠ‚ç‚¹

func deleteNode(root *TreeNode, key int) *TreeNode {
	x := root
	// xçš„çˆ¶èŠ‚ç‚¹
	var p *TreeNode
	for x !=nil {
		if x.Val == key {
			// æ‰¾åˆ°äº†è¦åˆ é™¤çš„èŠ‚ç‚¹
			//å¦‚æœæ˜¯å¶å­èŠ‚ç‚¹ï¼Œç›´æ¥åˆ é™¤
			if x.Left == nil && x.Right == nil{
				if  p == nil{
					root = nil

				}else{
					if p.Left == x {
						p.Left = nil
					}else{
						p.Right = nil
					}
				}
				x =nil
			}else if x.Right !=nil{
				//å¦‚æœè¯¥èŠ‚ç‚¹å­˜åœ¨å³å­æ ‘ï¼Œåˆ™æ‰¾åˆ°å½“å‰èŠ‚ç‚¹ä¸­åºéå†çš„åç»§èŠ‚ç‚¹
				s := successor(x)
				x.Val = s.Val
				x.Right=deleteNode(x.Right,s.Val)
			}else{
				// å³å­æ ‘ä¸å­˜åœ¨ä¸”å·¦å­æ ‘å­˜åœ¨ï¼Œæ­¤æ—¶xçš„åç»§èŠ‚ç‚¹ä½äºxçš„ä¸Šæ–¹ï¼Œæˆ‘ä»¬å¹¶æœªä¿å­˜ï¼Œ
				// xçš„å‰ç»§èŠ‚ç‚¹ä½äºä»–çš„ä¸‹æ–¹
				p := predecessor(x)
				x.Val = p.Val
				x.Left = deleteNode(x.Left,p.Val)
			}
		}else if x.Val > key {
			p =x
			x = x.Left
		}else{
			p =x
			x = x.Right
		}
	}
	return root
}
// è·å–åç»§èŠ‚ç‚¹
func successor(root *TreeNode) *TreeNode{
	if root == nil || root.Right == nil {
		return nil
	}
	// æ‰¾è¯¥èŠ‚ç‚¹ä¸­åºéå†çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ å³å­æ ‘ä¸Šæœ€å·¦èŠ‚ç‚¹

	r:= root.Right

	for r.Left!= nil{
		r = r.Left
	}
	return r
}
// è·å–å‰é©±èŠ‚ç‚¹:å·¦å­æ ‘ä¸Šçš„æœ€å³èŠ‚ç‚¹
func predecessor(root *TreeNode)* TreeNode{
	if root == nil || root.Left == nil{
		return nil
	}
	l := root.Left

	for l.Right != nil {
		l =l.Right
	}
	return l
}
//leetcode submit region end(Prohibit modification and deletion)


